---
title: |
    | **POLI 30 D: Political Inquiry**
    | \vspace{-.8cm}
author: |
    | \large\textbf{Professor Umberto Mignozzetti\\(Based on DSS Materials)}\vspace{.3cm}
date: |
    | \large\textbf{Lecture 08 | Prediction I}
fontsize: 12pt
urlcolor: blue
output:
  beamer_presentation:
    highlight: tango
    includes:
      in_header: 'https://raw.githubusercontent.com/umbertomig/POLI30Dpublic/main/latex/style.tex'
    incremental: true # if true: pauses are inserted after each item in a list
    keep_tex: false # if true: .tex files are kept (helpful when fixing errors)
    slide_level: 2
classoption: "handout" # overrides incremental, removes all pauses
---

```{r, include=FALSE}
library(tidyverse)
library(gridExtra)
knitr::opts_chunk$set(echo = TRUE)
knitr::knit_hooks$set(mysmall = function(before, options, envir) { 
  if (before) { 
    return("\\small") 
  } else { 
    return("\\normalsize") 
  } 
}) 
knitr::knit_hooks$set(myfntsize = function(before, options, envir) { 
  if (before) { 
    return("\\footnotesize") 
  } else { 
    return("\\normalsize") 
  } 
}) 
knitr::knit_hooks$set(mytiny = function(before, options, envir) { 
  if (before) { 
    return("\\tiny") 
  } else { 
    return("\\normalsize") 
  } 
})
knitr::opts_chunk$set(mysmall = TRUE)
```

## Before we start

**Announcements:**

- Quizzes and Participation: On Canvas.

- Github page: [https://github.com/umbertomig/POLI30Dpublic](https://github.com/umbertomig/POLI30Dpublic)

- Piazza forum: Not sure what the link is. Ask your TA!

- My mailbox disaster is not over, but things are in much better shape now! Please let me know if I missed your email.

- Note to self: Turn on the mic!

## Before we start

**Recap:** We learned:

- The definitions of theory, scientific theory, and hypotheses.
- Data, datasets, variables, and how to compute means.
- Causal effect, treatments, outcomes, and randomization.
- Sampling, descriptive statistics, and descriptive plots for one variable.
- Correlation between two continuous variables.

**Great job!**

- Do you have any questions about these contents?

***
\vspace{.5cm}
\begin{mdframed}[linecolor=title, linewidth=0.05cm]
\vspace{.2cm}
\begin{center}
\begin{tabular}{l}
\multicolumn{1}{c}{\large\concept{Why Do We Analyze Data?}\normalsize}\\\\
\color{gray}{1.} \color{gray} MEASURE: \textbf{To infer population}\\
\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\color{gray} \textbf{characteristics via survey research}\\
\,\,\,\,\,\,\,\, \color{gray} - what proportion of constituents support\\
\,\,\,\,\,\,\,\,\,\,\,\, \color{gray} a particular policy?\\\\

\color{gray}{2.} \color{black}  PREDICT: \concept{To make predictions} \\
\,\,\,\,\,\,\,\, - who is the most likely candidate to win\\
\,\,\,\,\,\,\,\,\,\,\,\, an upcoming election?\\\\

\color{gray}{3.} \color{gray}  EXPLAIN: \textbf{To estimate the causal effect of}\\
\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\color{gray}\textbf{a treatment on an outcome} \\
\,\,\,\,\,\,\,\, \color{gray}- what is the effect of small classrooms\\
\,\,\,\,\,\,\,\,\,\,\,\, \color{gray}on student performance?\\
\end{tabular}
\end{center}
\end{mdframed}

***
\begin{center}
\begin{minipage}{0.85\paperwidth}
\begin{mdframed}[backgroundcolor=white,linecolor=title, linewidth=0.05cm]
\vspace{.2cm}
\begin{center}
\begin{tabular}{l}
\multicolumn{1}{c}{\large\concept{\textbf{Plan for Today}}}\normalsize\\\\
- Prediction and Linear Regression\\
- Example with Non-binary Target Variable:\\
\,\,\,\, Use income to predict education expenditure\\[.3cm]
\,\,\,\, 1. Load and explore data\\
\,\,\,\, 2. Identify X and Y\\
\,\,\,\, 3. What is the relationship between X and Y?\\
\,\,\,\,\,\,\,\,\,\,\,\,         - Create scatter plot \\
\,\,\,\,\,\,\,\,\,\,\,\,         - Calculate correlation\\
\,\,\,\, 4. Fit a linear model using the least squares method\\
\,\,\,\, 5. Interpret coefficients\\
\,\,\,\, 6. Make predictions\\
\,\,\,\, \color{gray} 7. Measure how well the model fits the data\color{black}
\end{tabular}
\end{center}
\vspace{.2cm}
\end{mdframed}
\end{minipage}
\end{center}

***
1. \concept{When estimating causal effects}
    + $X$ is the **treatment** variable (independent variable)
    \vspace{-.05cm}
    + $Y$ is the **outcome** variable (dependent variable)
    \vspace{-.05cm}
    + Aim: to estimate the effect of $X$ on $Y$
    \vspace{-.05cm}
    + Assumption: Treatment and control groups are comparable
    \vspace{-.05cm}
    + Best way of satisfying assumption: random treatment assignment

2. \pause \concept{When infering population characteristics}
    + Aim: To infer the characteristics of $X$ in the population
    \vspace{-.05cm}
    + Assumption: sample is representative of population
    \vspace{-.05cm}
    + Best way of satisfying assumption: Random sampling
\vspace{-1cm}

***
3. \concept{When making predictions}
    + When we need to use what we know to learn what we do not know.
    + $X$ is a variable(s) that we use as predictor(s) (independent variable[s]; also k.a. **features**)
    + $Y$ is our **target variable**: what we want to predict
    + $Y_i \ = \ f(X_i) + \varepsilon$; Where $i$ is a given observation of interest; $f(.)$ is the *shape* of the relationship; and $\varepsilon$ is the (inherent) error that the process entails.
    + Aim: to predict $Y$ as accurately as possible
    + Assumption: The shape of $f$. We will assume linear: $f(X) = \beta_0 + \beta_1 X_i$.
    + Best way to achieve our aim: To make $\textrm{R}^2$ as high as possible.
\vspace{-1cm}

## Using Income to Predict Education Expenditures is US States

- Today we will analyze data on 1970 U.S. State Public-School Expenditures.

- Our goal is to model the relationship between per-capita income and per-capita education expenditures.

| **Variable** | **Meaning**                                 |
|--------------|---------------------------------------------|
| education    | Per-capita education expenditures, dollars. |
| income       | Per-capita income, dollars.                 |
| young        | Proportion under 18, per 1000.              |
| urban        | Proportion urban, per 1000.                 |
| states       | US State                                    |

\vspace{-1cm}

## Step 1: Load and Explore Data
```{r, collapse=TRUE, comment='##'}
grades <- read.csv("https://raw.githubusercontent.com/umbertomig/POLI30Dpublic/main/data/grades.csv")
educexp <- read.csv("https://raw.githubusercontent.com/umbertomig/POLI30Dpublic/main/data/educexp.csv")
head(educexp, 3)
```

- What is the unit of observation?
 
- For each variable: type and unit of measurement?

- Substantively interpret the first observation

\vspace{-1cm}
    
## Step 2: Identify the Dependent and Independent Variables

- The \concept{predictor (X)}\ is the variable we want to use to predict the outcome (Y).

- The \concept{target (Y)}\ is the variable that we want to predict.

- What are they?

```{r, fig.width=6, fig.height=2, echo=FALSE}
p1 <- ggplot(data = educexp, aes(x = income)) + 
  geom_histogram(bins = 7, color = 'black', fill = 'lightblue', alpha = 0.4) + labs(title = 'Per-Capita Income', y = '') + 
  theme_minimal()
p2 <- ggplot(data = educexp, aes(x = education)) + 
  geom_histogram(bins = 7, color = 'black', fill = 'lightblue', alpha = 0.4) + labs(title = 'Per-Capita Education Exp.', y = '') + 
  theme_minimal()
grid.arrange(p1, p2, nrow = 1)
```

## Step 3: What is the relationship between X and Y?

- Create \concept{scatter plot}\ to visualize the relationship between per-capita *income* and *education* expenditures.

```{r, fig.width=6, fig.height=3, echo=FALSE}
p <- ggplot(data = educexp, aes(x = income, y = education)) + 
#  geom_point(fill = 'lightblue', alpha = 0.4) + 
  geom_text(aes(label=states), size=2) + 
  labs(title = '', y = 'Per-Capita Education Expenditure', x = 'Per-Capita Income') + 
  theme_minimal()
p
```

\vspace{-2cm}

## Step 3: What is the relationship between X and Y?

```{r, fig.width=6, fig.height=2.5, echo=FALSE}
p
```

- The *Y variable* always goes in the *y-axis* and the *X variable* always goes in the *x-axis*.
\vspace{-0.1cm}
- Does the relationship look positive or negative?
\vspace{-0.1cm}
- Does the relationship look weekly or strongly linear?

\vspace{-2cm}

## Step 3: What is the relationship between X and Y?

- Let us now check the \concept{correlation}\ coefficient.

- It measures the direction and strength of linear association between *income* and *education*.

\vspace{0.2cm}

```{r, collapse=TRUE, comment='##', myfntsize = TRUE}
cor(educexp$income, educexp$education)
```

- We find a moderately strong positive correlation

- Are we surprised by this number? Think about what we have seen in the scatter plot.

\vspace{-2cm}

## Step 3: What is the relationship between X and Y?

We learned so far:

- That an increase in per-capita *income* is associated with an increase in *education* expenditure.

\vspace{.2cm}

- What we want to know is: When *income* increases, then **by how much** the *education* expenditure is predicted to increase?

\vspace{.2cm}

- In general we care about: When $X$ increases by one unit, by how much is $Y$ predicted to change?

\vspace{.2cm}

- To answer this question, we will fit a `regression` line to summarize the relationship between $X$ and $Y$

\vspace{-1cm}

## Step 4: Fit a linear model using the least squares method

\vspace{-.1cm}

- Which line better summarizes the relationship?

\vspace{-.1cm}

```{r, fig.width=6, fig.height=2.5, echo=FALSE}
p1 <- ggplot(data = educexp, aes(x = income, y = education)) + 
  geom_point(fill = 'lightblue', alpha = 0.4) + 
#  geom_text(aes(label=states), size=2) + 
  labs(title = '', y = '', x = '') + 
  geom_hline(yintercept = mean(educexp$education), color = 'blue', lwd = 1) + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 30))
p2 <- ggplot(data = educexp, aes(x = income, y = education)) + 
  geom_point(fill = 'lightblue', alpha = 0.4) + 
#  geom_text(aes(label=states), size=2) + 
  labs(title = '', y = '', x = '') + 
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 30)) + 
  geom_smooth(formula = 'y ~ x', method = 'lm', se = F, color = 'blue', lwd = 1)
grid.arrange(p1, p2, nrow = 1)
```

\vspace{-.2cm}

- The goal is the choose the line that best fits the data.
    + Which one you think does that?

\vspace{-2cm}
    
## Step 4: Fit a linear model using the least squares method

- To choose the line that best fits the data, we use \concept{the least squares method}.

- In \color{red}red\color{black}, you can see the *error* we make by approximating the *education* using the \color{blue}blue\color{black}\ trendline.

\vspace{-0.5cm}

```{r, fig.width=6, fig.height=2.5, echo=FALSE}
pred1dist <- rep(mean(educexp$education), dim(educexp)[1])
pred2dist <- as.numeric(lm('education ~ income', data = educexp)$fitted.values)
p1 <- ggplot(data = educexp, aes(x = income, y = education)) + 
  geom_point(fill = 'lightblue', alpha = 0.4) + 
  geom_segment(aes(xend = income, yend = pred1dist), color = "red", lty = 3) +
#  geom_text(aes(label=states), size=2) + 
  labs(title = '', y = '', x = '') + 
  geom_hline(yintercept = mean(educexp$education), color = 'blue', lwd = 1) + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 30))
p2 <- ggplot(data = educexp, aes(x = income, y = education)) + 
  geom_point(fill = 'lightblue', alpha = 0.4) + 
  geom_segment(aes(xend = income, yend = pred2dist), color = "red", lty = 3) +
#  geom_text(aes(label=states), size=2) + 
  labs(title = '', y = '', x = '') + 
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 30)) + 
  geom_smooth(formula = 'y ~ x', method = 'lm', se = F, color = 'blue', lwd = 1)
grid.arrange(p1, p2, nrow = 1)
```

\vspace{-0.5cm}

- Which plot you think is doing better?

\vspace{-1cm}

## Step 4: Fit a linear model using the least squares method

- We need to think about what *better* means: 
    + In the case of least square error, let the error in the prediction for a given US State $i$ be:

\vspace{-0.5cm}

$$ e_i \ = \ Y_i - \beta_0 - \beta_1 X_i $$

\vspace{-0.2cm}

- We need to find $\beta_0$ and $\beta_1$ that minimizes the sum of the squared error:

\vspace{-0.8cm}

$$ \min_{(\beta_0, \beta_1)} \sum_{i=1}^n e_i^2 \quad \text{which is the same as} \quad  \min_{(\beta_0, \beta_1)} \sum_{i=1}^n (Y_i - \beta_0 - \beta_1 X_i)^2$$
\vspace{-0.5cm}

- The meaning of *least square method* should now be clear to you.

\vspace{-2cm}

## Step 4: Fit a linear model using the least squares method

- The fitted line is \concept{$\widehat{Y}$ = $\widehat{\beta}_0$ + $\widehat{\beta}_1$ X}
    + \concept{$\widehat{\beta}_0$}\ is the intercept
    + \concept{$\widehat{\beta}_1$}\ is the slope

\vspace{.2cm}

- If you learned that a line was $Y = mX + b$
    + think that $m$ is now $\widehat{\beta}_1$
    + think that $b$ is now $\widehat{\beta}_0$
\vspace{.2cm}

- **^** (called 'hat') stands for predicted or estimated
    + $\widehat{Y}$ is the predicted target outcome
    + $\widehat{\beta}_0$ and $\widehat{\beta}_1$ are the estimated coefficients

\vspace{-1cm}

## Step 4: Fit a linear model using the least squares method

- The R function to fit a linear model is the \fu{lm()}:

```{r, collapse=TRUE, comment='##', myfntsize = TRUE}
lm('education ~ income', data = educexp)
```

```{r, echo = FALSE, results='hide'}
mod <- lm(education ~ income, data = educexp)
```

- $\widehat{\beta}_0$ = `r round(mod$coef[1], digits=2)` and $\widehat{\beta}_1$ = `r round(mod$coef[2], digits=2)`
- The fitted line is $\widehat{Y}$ = `r round(mod$coef[1], digits=2)` + `r round(mod$coef[2], digits=2)` $X$ 
- More specifically: $\widehat{\textrm{education}}$ = `r round(mod$coef[1], digits=2)` + `r round(mod$coef[2], digits=2)` $\textrm{income}$

\vspace{-2cm}

***
- We can now add the fitted line to the scatter plot above
- First, we store the fitted line in an object called *fit*
    ```{r, collapse=TRUE, comment='##',   mysize=TRUE,  size='\\small',   fig.width=8, fig.height=5}
    fit <- lm(grades$final ~ grades$midterm) # stores fitted line
    ```
- Then, we can use the function \fu{abline()}
    + required argument: name of object with fitted line \pause
    ```{r, collapse=TRUE, comment='##',   eval=F}
    abline(fit) # adds line to scatter plot
    ```

***
```{r, collapse=TRUE, comment='##', echo=FALSE, fig.width=8, fig.height=8, out.width = '75%', fig.align='center'}
par(mfrow = c(1,1),
          oma = c(1,0,1,0) + 0.1,
          mar = c(5,3,1,3) + 0.1,
          mgp = c(2,.5,0), cex=1.5, adj=1)    
plot(x=grades$midterm, y=grades$final, col="gray", pch=19, yaxt="n", xaxt="n", cex.lab=1, col.lab="gray17", bty="n", xlim=c(0,100), ylim=c(0,100))
axis(1, col="gray17", col.ticks="gray", col.axis="gray17", tck=-0.02)
axis(2, col="gray17", col.ticks="gray", col.axis="gray17", tck=-0.02)
box(col="gray17")
fit <- lm(grades$final ~ grades$midterm) # stores fitted line
abline(fit, col="red")
```

***
5. Interpretation of Coefficients: 

- \concept{The intercept ($\widehat{\alpha}$) is the $\widehat{Y}$ when $X$=0}
\vspace{-.1cm}

- Find 0 on the X-axis, go up to the line, find the value of $\widehat{Y}$ associated with X=0 
    ```{r, collapse=TRUE, comment='##', echo=FALSE, fig.width=8, fig.height=8, out.width = '58%', fig.align='center'}
par(mfrow = c(1,1),
          oma = c(1,0,1,0) + 0.1,
          mar = c(5,3,1,3) + 0.1,
          mgp = c(2,.5,0), cex=1.5, adj=1)    
plot(x=grades$midterm, y=grades$final, col="gray", pch=19, yaxt="n", xaxt="n", cex.lab=1, col.lab="gray17", bty="n", xlim=c(-40,100), ylim=c(-40,100))
axis(1, col="gray17", col.ticks="gray", col.axis="gray17", tck=-0.02)
axis(2, col="gray17", col.ticks="gray", col.axis="gray17", tck=-0.02)
box(col="gray17")
abline(fit, col="red") # add regression line
text(x=2, y=-10, labels=expression(paste("(0, ", widehat(alpha),") = (0, -6.01)")), col="red", cex=1.5, pos=4)
lines(x=c(0,0), y=c(-50,-6), col="red", lty="dashed", lwd=3)
lines(x=c(0,-50), y=c(-6,-6), col="red", lty="dashed", lwd=3)
points(x=0, y=fit$coeff[1], col="red", pch=19)
    ```
   \vspace{-.2cm}
    + here: $\widehat{\alpha}$ = `r round(fit$coeff[1], digits=2)`
    \vspace{-.1cm}


## Mathematical definition of $\widehat{\alpha}$

\begin{align*}
\widehat{Y} &= \widehat{\alpha} + \widehat{\beta}\,\, X  & \color{gray}(\textrm{by definition})\\
\widehat{Y} &= \widehat{\alpha} + \widehat{\beta}\times 0 &\color{gray}(\textrm{if } X=0)\\
\widehat{Y} &= \widehat{\alpha} + 0 &\color{gray}(\textrm{if } X=0)\\
\widehat{Y} &= \widehat{\alpha} &\color{gray}(\textrm{if } X=0)
\end{align*}

\pause
> \vspace{.2cm} \begin{center} $\widehat{\alpha}$ is the value of $\widehat{Y}$ when $X$=0 \end{center}


***
- **substantive interpretation of $\widehat{\alpha}$**?
    + start with mathematical definition: 
        + $\widehat{\alpha}$ is the $\widehat{Y}$ when *X*=0
    + substitute X, Y, and $\widehat{\alpha}$: 
        + $\widehat{\alpha}$ = `r round(fit$coef[1], digits=2)`  is the $\widehat{\textrm{\textit{final}}}$ when *midterm*=0
    + put it in words (using units of measurement): 
        + when a student scores 0 points in the midterm, we predict that in the final exam they will score -6.01 points, on average
    + sometimes it is nonsensical (due to extrapolation)

- **unit of measurement of $\widehat{\alpha}$**? 
    + same as $\overline{Y}$
    + in this case: *Y* is non-binary and measured in points so $\overline{Y}$ is measured in points and so is $\widehat{\alpha}$

***
5. Interpretation of Coefficients: 

- \concept{The slope ($\widehat{\beta}$) is the $\triangle \widehat{Y}$ associated with $\triangle X$=1}
\vspace{-.1cm}

- Pick two points on the line, measure $\triangle \widehat{Y}$ and $\triangle X$ associated with the two points, calculate $\triangle \widehat{Y}$/$\triangle X$
    ```{r, collapse=TRUE, comment='##', echo=FALSE, fig.width=8, fig.height=8, out.width = '58%', fig.align='center'}
par(mfrow = c(1,1),
          oma = c(1,0,1,0) + 0.1,
          mar = c(5,3,1,3) + 0.1,
          mgp = c(2,.5,0), cex=1.5, adj=1)    
plot(x=grades$midterm, y=grades$final, col="gray", pch=19, yaxt="n", xaxt="n", cex.lab=1, col.lab="gray17", bty="n", xlim=c(-40,100), ylim=c(-40,100))
axis(1, col="gray17", col.ticks="gray", col.axis="gray17", tck=-0.02)
axis(2, col="gray17", col.ticks="gray", col.axis="gray17", tck=-0.02)
box(col="gray17")
abline(fit, col="red") # add regression line

lines(x=c(0,0), y=c(-50,-6), col="red", lty="dashed", lwd=3)
lines(x=c(0,-50), y=c(-6,-6), col="red", lty="dashed", lwd=3)
points(x=0, y=fit$coeff[1], col="red", pch=19)
text(x=2, y=-10, labels=expression(paste("(0, -6.01)")), col="red", cex=1.5, pos=4)

lines(x=c(80,80), y=c(-50,-6+0.97*80), col="red", lty="dashed", lwd=3)
lines(x=c(80,-50), y=c(-6+0.97*80,-6+0.97*80), col="red", lty="dashed", lwd=3)
points(x=80, y=-6+0.97*80, col="red", pch=19)
text(x=80, y=78.6, labels=expression(paste("(80, 71.6)")), col="red", cex=1.5, pos=2)

arrows(-35, 0,-35, 68, code=2, lwd=3, length=.1, col="#ef3119")
text(x=-35, y=30, labels=expression(paste("rise")), col="red", cex=1.5, pos=4)
arrows(5, -35, 75, -35, code=2, lwd=3, length=.1, col="#ef3119")
text(x=28.5, y=-30, labels=expression(paste("run")), col="red", cex=1.5, pos=4)
    ```
    \vspace{-.2cm}
    + here: $\widehat{\beta}$ = $\frac{\textrm{rise}}{\textrm{run}} = \frac{\textrm{71.6-(-6.01)}}{\textrm{80-0}}=\frac{\textrm{77.61}}{\textrm{80}}=\textrm{0.97}$
    \vspace{-.1cm}

***
\vspace{1cm}
\begin{center}\includegraphics[height=.55\textheight]{../../images/change.png}\end{center}

\begin{eqnarray*}
\triangle \widehat{Y} &=& \widehat{Y}_{\textrm{final}} {-} \widehat{Y}_{\textrm{initial}}\\
\triangle X &=& X_{\textrm{final}} {-} X_{\textrm{initial}}\\
\end{eqnarray*}


## Mathematical definition of $\widehat{\beta}$

\vspace{.2cm}
\begin{align*}
\triangle \widehat{Y} &= \widehat{Y}_{\textrm{final}} {-} \widehat{Y}_{\textrm{initial}} & \color{gray}(\textrm{by definition}) \\
\triangle \widehat{Y} &= (\widehat{\alpha} + \widehat{\beta} X_{\textrm{final}}) - (\widehat{\alpha} + \widehat{\beta} X_{\textrm{initial}}) & \color{gray}(\textrm{since } \widehat{Y}_{\textrm{final}}= \widehat{\alpha} + \widehat{\beta} X_{\textrm{final}} \,\,\,\,\\
&& \color{gray}\textrm{and } \widehat{Y}_{\textrm{initial}}= \widehat{\alpha} + \widehat{\beta} X_{\textrm{initial}}) \\
\triangle \widehat{Y} &= \widehat{\alpha} - \widehat{\alpha} + \widehat{\beta} \,(X_{\textrm{final}}{-} X_{\textrm{initial}}) & \color{gray}(\textrm{rearranging terms}) \\
\triangle \widehat{Y} &= \widehat{\beta} \,(X_{\textrm{final}}{-} X_{\textrm{initial}}) & \color{gray}(\textrm{since }\widehat{\alpha} - \widehat{\alpha} = 0)\\
\triangle \widehat{Y} &= \widehat{\beta} \,(\triangle X) & \color{gray}(\textrm{since } \triangle X = X_{\textrm{final}} - X_{\textrm{initial}}) \\
\triangle \widehat{Y} &= \widehat{\beta} \times 1 &\color{gray}(\textrm{if } \triangle X=1)\\
\triangle \widehat{Y} &= \widehat{\beta} &\color{gray}(\textrm{if } \triangle X=1)
\end{align*}

\vspace{-.1cm}\pause
> \vspace{.2cm} $\widehat{\beta}$ is the value of $\triangle \widehat{Y}$ associated with $\triangle X$ = 1

***
- **substantive interpretation of $\widehat{\beta}$**?
    + start with mathematical definition: 
        + $\widehat{\beta}$ is the $\triangle \widehat{Y}$ associated with $\triangle X$=1
    + substitute X, Y, and $\widehat{\beta}$: 
        + $\widehat{\beta}$ = `r round(fit$coef[2], digits=2)` is the $\triangle \widehat{\textrm{\textit{final}}}$ associated with $\triangle$*midterm*=1
    + put it in words (using units of measurement): 
        + an increase in midterm scores of 1 point is associated with a predicted increase in final exam scores of 0.97 points, on average
    + has the same sign as the cor(X,Y) (always the case!)

- **unit of measurement of $\widehat{\beta}$**?
    + same as $\triangle \overline{Y}$
    + in this case: *Y* is non-binary and measured in points so $\triangle \overline{Y}$ is measured in points and so is $\widehat{\beta}$

***
\begin{mdframed}[linecolor=titleline, linewidth=0.05cm, innerleftmargin=.5cm,innerrightmargin=.5cm]
\vspace{.3cm} 
\begin{center}\color{concept}\tip{The fitted line is}:\color{text}\end{center}
$$\widehat{Y} = \widehat{\alpha} + \widehat{\beta} X$$

\begin{tabular}{l}
- $\widehat{\alpha}$ (alpha-hat) is the estimated intercept coefficient\\
\,\,\,\,\,\,\,\,\,\,\,the $\widehat{Y}$ when $X{=}\textrm{0}$\\
\,\,\,\,\,\,\,\,\,\,\,(in same unit of measurement as $\overline Y$)\\\\

- $\widehat{\beta}$ (beta-hat) is the estimated slope coefficient\\
\,\,\,\,\,\,\,\,\,\,\,the $\triangle \widehat{Y}$ associated with $\triangle X{=}\textrm{1}$\\
\,\,\,\,\,\,\,\,\,\,\,(in the same unit of measurement as $\triangle\overline Y$)
\end{tabular}
\vspace{.2cm}
\end{mdframed}

***
6. Make predictions

- Now that we have found the line that best summarizes the relationship between X and Y, we can use it to make predictions
\vspace{.2cm}

- There are two types of predictions that we might be interested in:
\vspace{.3cm}
    1. predict $\widehat{Y}$ based on $X$: \concept{$\widehat{Y} = \widehat{\alpha} + \widehat{\beta} X$}
    2. predict $\triangle \widehat{Y}$ associated with $\triangle X$: \concept{$\triangle \widehat{Y} = \widehat{\beta} \triangle X$}
    
***
\begin{mdframed}[linecolor=titleline, linewidth=0.05cm] 
\noindent To predict $\widehat{Y}$ based on $X$: \color{titleline} $\widehat{Y} = \widehat{\alpha} + \widehat{\beta} X$
\end{mdframed}

- \underline{Example 1}: Imagine you earn 80 points in the midterm, what would we predict your final exam score will be? 

\vspace{-.9cm}\pause
\begin{eqnarray*}
\widehat{\textrm{final}} &=& \pause \textrm{`r round(fit$coef[1], digits=2)`} + \pause \textrm{`r round(fit$coef[2], digits=2)`} \pause \,\,\textrm{\,\,midterm} \pause \\
\widehat{\textrm{final}} &=& \textrm{`r round(fit$coef[1], digits=2)`} + \textrm{`r round(fit$coef[2], digits=2)`} \times \pause \textrm{80} \color{gray} \textrm{\,\, (if midterm = 80)} \pause\\ 
\widehat{\textrm{final}} &=& \pause \textrm{`r round(fit$coef[1], digits=2) + round(fit$coef[2], digits=2)*80`} \\
\end{eqnarray*}
\vspace{-1.5cm}\pause

- Answer: If you earn 80 points in the midterm, we would predict that you will earn \pause 71.59 \pause points in the final exam, on average
- Note: $\widehat{Y}$ is in the same unit of measurement as $\overline{Y}$
    + in this case: Y is non-binary and measured in points so $\overline{Y}$ and $\widehat{Y}$ are also measured in points
\vspace{-1cm}    

***
- \underline{Example 2}: Imagine you earn 90 points in the midterm, what would we predict your final exam score will be?

\vspace{-.9cm}\pause
\begin{eqnarray*}
\widehat{\textrm{final}} &=& \pause  \textrm{`r round(fit$coef[1], digits=2)`} + \pause \textrm{`r round(fit$coef[2], digits=2)`} \pause \,\,\textrm{\,\,midterm} \pause\\
\widehat{\textrm{final}} &=& \textrm{`r round(fit$coef[1], digits=2)`} + \textrm{`r round(fit$coef[2], digits=2)`} \times \pause \textrm{90} \color{gray} \textrm{\,\, (if midterm = 90)} \pause\\ 
\widehat{\textrm{final}} &=& \pause \textrm{`r round(fit$coef[1], digits=2) + round(fit$coef[2], digits=2)*90`} \\
\end{eqnarray*}
\vspace{-1.5cm}\pause

- Answer: If you earn 90 points in the midterm, we would predict that you will earn \pause 81.29 \pause points in the final exam, on average

***
\begin{mdframed}[linecolor=titleline, linewidth=0.05cm]
\noindent To predict $\triangle \widehat{Y}$ associated with $\triangle X$: \color{titleline} $\triangle \widehat{Y} = \widehat{\beta} \, \triangle \text{X}$
\end{mdframed}
- \underline{Example 3}: If you increase your midterm scores by 10 points, by how much would we predict that your final exam scores would change?

\vspace{-.9cm}\pause
\begin{eqnarray*}
\triangle\widehat{\textrm{final}} &=& \pause \textrm{`r round(fit$coef[2], digits=2)`} \pause \,\,\triangle\textrm{midterm} \pause \\
\triangle \widehat{\textrm{final}} &=& \pause \textrm{`r round(fit$coef[2], digits=2)`} \pause \times \textrm{10} \color{gray} \textrm{\,\, (if $\triangle$midterm = 10)} \color{black} \pause \\
\triangle \widehat{\textrm{final}} &=& \pause \textrm{`r round(fit$coef[2], digits=2)*10`} \\
\end{eqnarray*}
\vspace{-1.6cm}\pause

- Answer: An increase of midterm scores of 10 points is associated with a predicted \pause increase of final exam scores of \pause 9.7 \pause points, on average
- Note: $\triangle\widehat{Y}$ is in the same unit of measurement as $\triangle\overline{Y}$
    + in this case: Y is non-binary and measured in points so $\triangle\overline{Y}$ and $\triangle\widehat{Y}$ are also measured in points
\vspace{-1cm}    

***
7. Measure how well the model fits the data with $\textrm{R}^2$

- We will see how to do this next lecture

***
\color{black}
\begin{center}
\begin{tabular}{l}
\concept{\textbf{Today's Class}}\\
- How to summarize the relationship between \\
\,\,\,\,X and Y with a line: \fu{lm()} and \fu{abline()}\\[.3cm]
- How to interpret the two estimated coefficients: \\
\,\,\,\,($\widehat{\alpha}$ and $\widehat{\beta}$) when outcome variable is non-binary \\[.3cm]
- How to make predictions with the fitted line:\\ 
\,\,\,\,predict $\widehat{Y}$ based on $X$ and predict $\triangle\widehat{Y}$ based on $\triangle X$\\\\
\concept{\textbf{Next Class}}\color{black}\\
- Another example of how to use the linear\\
\,\,\,\,model to make predictions, but with binary outcome\\[.3cm]
- How to measure how well the model fits\\
\,\,\,\,the data with $\textrm{R}^2$\\
\end{tabular}
\end{center}
\vspace{-1cm}

## For Next Class
Here is the friendly reminder of what is due for next class:

> - Go see the peer tutors (plan ahead)
> - Review what you have learned thus far (lectures 2-10)
> - Do new set of readings: section 4.6-4.9 (including both, following along the exercises with your own computer, skip 4.8)
> - Bring your course packets to class
\vspace{-1cm}

## Summary

\vspace{1cm}

* **Today's Class:**
  + Exploring the Relationship Between Two Variables
    + Scatterplots
    + Correlations

\vspace{1cm}

* Next class:
  + Prediction and Linear Regression
  
# Questions?

# See you in the next class!